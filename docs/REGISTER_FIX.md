# Исправление ошибки 500 при регистрации

## Проблема
При запросе к эндпоинту `register/` возникала ошибка 500 (Internal Server Error).

## Причины ошибки
1. **Отсутствующие сериализаторы** - в `serializers.py` не было `UserSerializer` и других необходимых сериализаторов
2. **Недостаточная обработка ошибок** - отсутствовала обработка исключений в `RegisterView`
3. **Слабая валидация** - не было проверки длины пароля и имени пользователя

## Исправления

### 1. Созданы недостающие сериализаторы (backend/library/serializers.py)
```python
# Сериализатор для пользователя
class UserSerializer(serializers.ModelSerializer):
    class Meta:
        model = User
        fields = ['id', 'username', 'email', 'first_name', 'last_name', 'date_joined']
        read_only_fields = ['id', 'date_joined']

# Сериализатор для книги
class BookSerializer(serializers.ModelSerializer):
    class Meta:
        model = Book
        fields = '__all__'

# Сериализатор для отзыва
class ReviewSerializer(serializers.ModelSerializer):
    class Meta:
        model = Review
        fields = '__all__'

# Сериализатор для настроек сайта
class SiteSettingSerializer(serializers.ModelSerializer):
    class Meta:
        model = SiteSetting
        fields = '__all__'
```

### 2. Улучшена обработка ошибок в RegisterView
- Добавлен блок `try-except` для перехвата исключений
- Улучшена валидация входных данных
- Добавлены проверки длины имени пользователя и пароля
- Проверка уникальности email

### 3. Улучшена валидация данных
- **Имя пользователя**: минимум 3 символа
- **Пароль**: минимум 6 символов
- **Email**: проверка уникальности
- **Обязательные поля**: username и password

### 4. Улучшен LoginView
- Добавлена обработка исключений
- Улучшены сообщения об ошибках
- Возврат дополнительной информации о пользователе

## Новый формат ответов

### Успешная регистрация (201)
```json
{
  "message": "Пользователь успешно зарегистрирован",
  "user_id": 123,
  "username": "testuser"
}
```

### Ошибка валидации (400)
```json
{
  "error": "Имя пользователя должно содержать минимум 3 символа"
}
```

### Ошибка сервера (500)
```json
{
  "error": "Ошибка при регистрации: [детали ошибки]"
}
```

## Проверка работы
1. Перезапустите Django сервер: `python manage.py runserver`
2. Попробуйте зарегистрировать нового пользователя
3. Проверьте, что ошибка 500 больше не возникает
4. Убедитесь, что валидация работает корректно

## Тестирование
- ✅ Регистрация с корректными данными
- ✅ Валидация длины имени пользователя
- ✅ Валидация длины пароля
- ✅ Проверка уникальности username
- ✅ Проверка уникальности email
- ✅ Обработка серверных ошибок
